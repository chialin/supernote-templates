# PRD：Generator 與 Web 整合 - 模板瀏覽與下載功能

## 簡介/概述

本功能將 `@supernote-templates/generator` 產生的 PNG 模板整合到 `@supernote-templates/web` 網站，讓使用者可以瀏覽所有可用模板、查看預覽圖，並下載適合其 Supernote 裝置的 PNG 檔案。

目前 generator 已能成功產生模板的 PNG 檔案，但這些檔案尚未出現在網站上。使用者無法從網站瀏覽或下載模板。本功能將建立完整的整合流程，從建構時的檔案傳遞、元資料管理，到使用者介面的瀏覽與下載體驗。

基於 [docs/research/2026-01-11-generator-web-integration.md](../../research/2026-01-11-generator-web-integration.md) 的研究發現，採用「npm workspace 依賴 + prebuild 腳本」整合方案，並使用「HTML head 內嵌 meta 標籤」管理模板元資料。

## 目標

1. **建構流程自動化**：執行 `npm run build` 時，自動完成 PNG 產生、元資料提取、檔案複製，無需人工介入
2. **模板可瀏覽**：使用者可在網站上看到所有可用模板的預覽圖、名稱和描述
3. **模板可下載**：使用者可選擇裝置版本（Nomad 或 Manta）並下載對應的 PNG 檔案
4. **多語言支援**：模板名稱和描述支援現有的三種語言（英文、繁體中文、日文）

## 使用者故事

### US1：瀏覽模板列表

> 作為一位 Supernote 使用者，我想要在網站上瀏覽所有可用的模板，以便找到適合我需求的模板。

**情境描述**：
使用者進入網站首頁，看到模板列表以網格方式呈現。每個模板顯示預覽圖、名稱和簡短描述。使用者可以快速掃視所有選項。

### US2：查看模板詳情

> 作為一位 Supernote 使用者，我想要查看模板的詳細資訊和更大的預覽圖，以便確認這是否符合我的需求。

**情境描述**：
使用者點擊某個模板卡片，進入模板詳情頁。頁面顯示較大的預覽圖、完整的描述，以及該模板支援的裝置列表。

### US3：下載特定裝置版本

> 作為一位 Supernote Nomad 使用者，我想要下載適合我裝置的 PNG 檔案，以便將模板傳輸到我的裝置使用。

**情境描述**：
使用者在模板詳情頁看到下載選項，選擇「Nomad」版本，瀏覽器開始下載對應的 PNG 檔案。檔案名稱清晰標示模板名稱，方便使用者辨識。

### US4：多語言瀏覽

> 作為一位日本使用者，我想要用日文瀏覽模板資訊，以便更容易理解每個模板的用途。

**情境描述**：
使用者透過語言切換器選擇日文，網站介面和模板的名稱、描述都切換為日文顯示。

## 功能需求

### 建構與整合（Phase 1）

1. **FR1.1**：系統必須在每個 HTML 模板的 `<head>` 區塊讀取 meta 標籤，提取模板的名稱和描述（支援 en、zh-TW、ja 三種語言）
2. **FR1.2**：系統必須在 generator 建構時自動產生 `templates.json` 檔案，包含所有模板的元資料
3. **FR1.3**：系統必須在 web 建構前自動將 generator 的輸出（PNG 檔案和 templates.json）複製到 web 的 public 目錄
4. **FR1.4**：執行根目錄的 `npm run build` 必須自動完成上述所有步驟，順序正確且無需人工介入

### 使用者介面（Phase 2）

5. **FR2.1**：網站首頁必須以網格形式顯示所有可用模板
6. **FR2.2**：每個模板卡片必須顯示：預覽圖、模板名稱、模板描述
7. **FR2.3**：點擊模板卡片必須導向該模板的詳情頁面
8. **FR2.4**：模板詳情頁必須顯示：較大的預覽圖、完整描述、支援的裝置列表
9. **FR2.5**：模板詳情頁必須提供裝置版本選擇，讓使用者選擇要下載 Nomad 或 Manta 版本
10. **FR2.6**：點擊下載按鈕必須開始下載對應的 PNG 檔案
11. **FR2.7**：所有模板的名稱和描述必須根據使用者選擇的語言顯示對應翻譯

## 非目標（超出範圍）

- **分類篩選**：本次不實作模板分類功能（category 欄位暫不使用）
- **搜尋功能**：本次不實作模板搜尋
- **縮圖產生**：不額外產生縮圖，直接使用原圖並透過 CSS 控制顯示尺寸
- **批次下載**：不提供一次下載多個模板或同時下載兩個裝置版本的功能
- **使用者帳號**：不需要登入或帳號系統
- **模板上傳**：使用者無法上傳自己的模板

## 設計考量

### 模板卡片

- 預覽圖使用固定的顯示尺寸，透過 CSS 縮放原圖
- 卡片應有 hover 效果，暗示可點擊
- 在不同螢幕尺寸下，網格欄數應自適應（桌面 3-4 欄、平板 2 欄、手機 1 欄）

### 模板詳情頁

- 預覽圖佔據頁面主要視覺區域
- 下載選項以按鈕形式呈現，清楚標示裝置名稱（Nomad / Manta）
- 提供返回列表的導航

### 響應式設計

- 網站必須在桌面、平板、手機上都能正常瀏覽和下載

## 技術考量

- 採用 npm workspace 依賴建立 generator 與 web 的關聯，確保 Turborepo 正確處理建構順序
- 使用跨平台的 Node.js 腳本處理檔案複製（避免 shell 指令的平台差異）
- 靜態匯出模式下，所有模板頁面需在建構時預先產生
- 善用 Cloudflare 的自動圖片優化和快取功能

## 設計決策

1. **預覽圖選擇**：統一使用 Nomad 版本作為預覽圖，因為 Nomad 解析度較小（1404×1872），縮放顯示時內容更清晰易讀
2. **檔案命名**：下載的 PNG 檔案名稱格式為 `{模板名稱}-{裝置名稱}.png`，例如 `daily-routine-nomad.png`，方便使用者辨識檔案對應的裝置
3. **空狀態處理**：當沒有任何模板時，首頁顯示空狀態頁面，包含友善的提示訊息（例如「目前沒有可用的模板」）

## 參考資料

- [研究文件：Generator 與 Web 整合](../../research/2026-01-11-generator-web-integration.md)
- [Turborepo 依賴管理](https://turborepo.com/docs/crafting-your-repository/managing-dependencies)
- [Next.js 靜態匯出](https://nextjs.org/docs/app/guides/static-exports)
